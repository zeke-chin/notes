```
ps aux | grep "[/]Users/zeke/work/workspace/wm_work/saas_embdb/.venv/bin/python" | awk '
# 定义一个转换函数，将 KB 转换为人类可读格式
function hr(kb) {
    if (kb >= 1048576) return sprintf("%.2f GB", kb / 1048576);
    if (kb >= 1024) return sprintf("%.2f MB", kb / 1024);
    return kb " KB";
}
BEGIN {
    # 调整了表头，增加了 MEM_RSS
    printf "%-8s %-8s %-10s %-s\n", "PID", "CPU%", "MEM_RSS", "COMMAND";
    print "--------------------------------------------------";
}
{
    cpu += $3;
    rss_total += $6; # 第6列是 RSS (单位 KB)
    
    # 打印每一行
    printf "%-8s %-8.1f %-10s %-s\n", $2, $3, hr($6), $11;
}
END {
    print "--------------------------------------------------";
    printf "%-8s %-8.1f %-10s %-s\n", "TOTAL", cpu, hr(rss_total), "Processes: " NR;
}'
```

```
watch -n 1 "ps aux | grep '[/]Users/zeke/work/workspace/wm_work/saas_embdb/.venv/bin/python' | awk 'function hr(kb) { if (kb >= 1048576) return sprintf(\"%.2f GB\", kb / 1048576); if (kb >= 1024) return sprintf(\"%.2f MB\", kb / 1024); return kb \" KB\"; } BEGIN { printf \"%-8s %-8s %-10s %-s\\n\", \"PID\", \"CPU%\", \"MEM_RSS\", \"COMMAND\"; print \"--------------------------------------------------\"; } { cpu += \$3; rss_total += \$6; printf \"%-8s %-8.1f %-10s %-s\\n\", \$2, \$3, hr(\$6), \$11; } END { print \"--------------------------------------------------\"; printf \"%-8s %-8.1f %-10s %-s\\n\", \"TOTAL\", cpu, hr(rss_total), \"Processes: \" NR; }'"
```